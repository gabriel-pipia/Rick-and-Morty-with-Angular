<section class="Characters-Page">
  <div class="Container">
    <!-- Header -->
    <div class="Page-Header">
      <h1>Characters</h1>
      <p class="Subtitle">Discover {{ TotalCharacters || 'all' }} characters from the Rick and Morty universe</p>
    </div>

    <!-- Filters Section -->
    <div class="Filters-Section">
      <!-- Search -->
      <div class="Search-Wrapper">
        <i class="fas fa-search"></i>
        <input 
          type="text" 
          placeholder="Search by name..." 
          [(ngModel)]="SearchQuery"
          (input)="OnSearchChange()"
        />
        <button 
          class="Clear-Btn" 
          *ngIf="SearchQuery" 
          (click)="SearchQuery = ''; OnSearchChange()">
          <i class="fas fa-times"></i>
        </button>
      </div>

      <!-- Species Select -->
      <div class="Select-Wrapper">
        <select (change)="OnSpeciesChange($event)">
          <option value="all" [selected]="SelectedSpecies === 'all'">All Species</option>
          <option *ngFor="let species of SpeciesOptions" [value]="species" [selected]="SelectedSpecies === species">
            {{ species }}
          </option>
        </select>
        <i class="fas fa-chevron-down"></i>
      </div>
    </div>

    <!-- Filter Chips -->
    <div class="Filter-Chips">
      <!-- Status Filter -->
      <div class="Chip-Group">
        <span class="Chip-Label">Status:</span>
        <button 
          class="Chip" 
          [class.active]="SelectedStatus === 'all'"
          (click)="OnStatusChange('all')">
          All
        </button>
        <button 
          *ngFor="let status of StatusOptions" 
          class="Chip"
          [class.active]="SelectedStatus === status"
          [ngClass]="status.toLowerCase()"
          (click)="OnStatusChange(status)">
          <span class="Status-Dot"></span>
          {{ status }}
        </button>
      </div>

      <!-- Gender Filter -->
      <div class="Chip-Group">
        <span class="Chip-Label">Gender:</span>
        <button 
          class="Chip" 
          [class.active]="SelectedGender === 'all'"
          (click)="OnGenderChange('all')">
          All
        </button>
        <button 
          *ngFor="let gender of GenderOptions" 
          class="Chip"
          [class.active]="SelectedGender === gender"
          (click)="OnGenderChange(gender)">
          {{ gender }}
        </button>
      </div>
    </div>

    <!-- Results Info -->
    <div class="Results-Info">
      <span class="Count" *ngIf="!IsLoading && !NotFound">
        Showing {{ Filtered__Characters.length }} of {{ TotalCharacters }} characters
      </span>
      <button class="Reset-Btn" *ngIf="HasActiveFilters()" (click)="ClearFilters()">
        <i class="fas fa-redo"></i> Reset All
      </button>
    </div>

    <!-- Loading State -->
    <div class="Loading-State" *ngIf="IsLoading">
      <div class="Loader"></div>
      <p>Loading characters...</p>
    </div>

    <!-- No Results -->
    <div class="No-Results" *ngIf="NotFound && !IsLoading">
      <i class="fas fa-user-slash"></i>
      <h3>No characters found</h3>
      <p>Try different filters or search terms</p>
      <button (click)="ClearFilters()">Clear All Filters</button>
    </div>

    <!-- Characters Grid -->
    <main class="Characters-Grid" *ngIf="!IsLoading && !NotFound">
      <app-card 
        *ngFor="let Character of Filtered__Characters | paginate: {
          itemsPerPage: ItemSize,
          currentPage: Page,
          totalItems: TotalCharacters
        }" 
        [Character]="Character">
      </app-card>
    </main>

    <!-- Pagination -->
    <pagination-template 
      #pagination="paginationApi" 
      (pageChange)="PageChange($event)"
      *ngIf="!IsLoading && TotalCharacters > ItemSize">
      <div class="Pagination-Controls">
        <button 
          class="Page-Btn" 
          [disabled]="pagination.isFirstPage()" 
          (click)="pagination.previous()">
          <i class="fas fa-chevron-left"></i>
        </button>
        
        <div class="Page-Numbers">
          <button
            *ngFor="let page of pagination.pages"
            class="Page-Number"
            [class.active]="pagination.getCurrent() === page.value"
            (click)="pagination.setCurrent(page.value)">
            {{ page.label }}
          </button>
        </div>
        
        <button 
          class="Page-Btn" 
          [disabled]="pagination.isLastPage()" 
          (click)="pagination.next()">
          <i class="fas fa-chevron-right"></i>
        </button>
      </div>
    </pagination-template>
  </div>
</section>
